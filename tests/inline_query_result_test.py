import msgspec
import pytest

from aiotgbot.api_types import (
    DocumentMimeType,
    InlineQueryResult,
    InlineQueryResultArticle,
    InlineQueryResultAudio,
    InlineQueryResultCachedAudio,
    InlineQueryResultCachedDocument,
    InlineQueryResultCachedGif,
    InlineQueryResultCachedMpeg4Gif,
    InlineQueryResultCachedPhoto,
    InlineQueryResultCachedSticker,
    InlineQueryResultCachedVideo,
    InlineQueryResultCachedVoice,
    InlineQueryResultContact,
    InlineQueryResultDocument,
    InlineQueryResultGame,
    InlineQueryResultGif,
    InlineQueryResultLocation,
    InlineQueryResultMpeg4Gif,
    InlineQueryResultPhoto,
    InlineQueryResultVenue,
    InlineQueryResultVideo,
    InlineQueryResultVoice,
    InputTextMessageContent,
    VideoMimeType,
)


@pytest.mark.parametrize(
    "inline_query_result,json",
    (
        (
            InlineQueryResultArticle(
                id="",
                title="",
                input_message_content=InputTextMessageContent(message_text=""),
            ),
            b'{"type":"article","id":""',
        ),
        (
            InlineQueryResultPhoto(
                id="",
                photo_url="",
                thumbnail_url="",
            ),
            b'{"type":"photo","id":""',
        ),
        (
            InlineQueryResultGif(
                id="",
                gif_url="",
                thumbnail_url="",
            ),
            b'{"type":"gif","id":""',
        ),
        (
            InlineQueryResultMpeg4Gif(
                id="",
                mpeg4_url="",
                thumbnail_url="",
            ),
            b'{"type":"mpeg4_gif","id":""',
        ),
        (
            InlineQueryResultVideo(
                id="",
                video_url="",
                mime_type=VideoMimeType.HTML,
                thumbnail_url="",
                title="",
            ),
            b'{"type":"video","id":""',
        ),
        (
            InlineQueryResultAudio(
                id="",
                audio_url="",
                title="",
            ),
            b'{"type":"audio","id":""',
        ),
        (
            InlineQueryResultVoice(
                id="",
                voice_url="",
                title="",
            ),
            b'{"type":"voice","id":""',
        ),
        (
            InlineQueryResultDocument(
                id="",
                title="",
                document_url="",
                mime_type=DocumentMimeType.PDF,
            ),
            b'{"type":"document","id":""',
        ),
        (
            InlineQueryResultLocation(
                id="",
                latitude=0,
                longitude=0,
                title="",
            ),
            b'{"type":"location","id":""',
        ),
        (
            InlineQueryResultVenue(
                id="",
                latitude=0,
                longitude=0,
                title="",
                address="",
            ),
            b'{"type":"venue","id":""',
        ),
        (
            InlineQueryResultContact(
                id="",
                phone_number="",
                first_name="",
            ),
            b'{"type":"contact","id":""',
        ),
        (
            InlineQueryResultGame(
                id="",
                game_short_name="",
            ),
            b'{"type":"game","id":""',
        ),
        (
            InlineQueryResultCachedPhoto(
                id="",
                photofileid="",
            ),
            b'{"type":"photo","id":""',
        ),
        (
            InlineQueryResultCachedGif(
                id="",
                gif_file_id="",
            ),
            b'{"type":"gif","id":""',
        ),
        (
            InlineQueryResultCachedMpeg4Gif(
                id="",
                mpeg4_file_id="",
            ),
            b'{"type":"mpeg4_gif","id":""',
        ),
        (
            InlineQueryResultCachedSticker(
                id="",
                sticker_file_id="",
            ),
            b'{"type":"sticker","id":""',
        ),
        (
            InlineQueryResultCachedDocument(
                id="",
                title="",
                document_file_id="",
            ),
            b'{"type":"document","id":""',
        ),
        (
            InlineQueryResultCachedVideo(
                id="",
                video_file_id="",
                title="",
            ),
            b'{"type":"video","id":""',
        ),
        (
            InlineQueryResultCachedVoice(
                id="",
                voice_file_id="",
                title="",
            ),
            b'{"type":"voice","id":""',
        ),
        (
            InlineQueryResultCachedAudio(
                id="",
                audio_file_id="",
            ),
            b'{"type":"audio","id":""',
        ),
    ),
)
def test_inline_query_result(
    inline_query_result: InlineQueryResult,
    json: bytes,
) -> None:
    assert msgspec.json.encode(inline_query_result).startswith(json)
